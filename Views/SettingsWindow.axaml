<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Omoi.ViewModels"
        xmlns:models="using:Omoi.Models"
        x:Class="Omoi.Views.SettingsWindow"
        x:DataType="vm:SettingsWindowViewModel"
        Title="Settings"
        Width="650" Height="900"
        WindowStartupLocation="CenterOwner">

    <TabControl>
        <TabItem Header="Integrations">
            <ScrollViewer Padding="20">
                <StackPanel Spacing="25">
                    
                    <!-- Language models section -->
                    <TextBlock Text="Language models" 
                               FontWeight="Bold" 
                               FontSize="16"
                               Margin="0,0,0,10"/>
                    
                    <!-- Anthropic -->
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                        <StackPanel Spacing="10">
                            <TextBlock Text="Anthropic" FontWeight="Bold" FontSize="14"/>
                            
                            <Grid ColumnDefinitions="Auto,*,Auto" IsVisible="{Binding HasAnthropicKey}">
                                <TextBlock Grid.Column="0" Text="Current Key:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="{Binding AnthropicKeyDisplay}" 
                                          VerticalAlignment="Center"
                                          FontFamily="Consolas,Courier New,monospace"/>
                                <Button Grid.Column="2" 
                                       Content="Delete" 
                                       Click="DeleteAnthropicKey_Click"
                                       Margin="10,0,0,0"/>
                            </Grid>
                            
                            <StackPanel Spacing="10" IsVisible="{Binding !HasAnthropicKey}">
                                <TextBox Text="{Binding AnthropicKeyInput}" 
                                        Watermark="sk-ant-..."
                                        PasswordChar="•"/>
                                <Button Content="Add" 
                                       Click="AddAnthropicKey_Click"
                                       HorizontalAlignment="Right"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- OpenAI -->
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                        <StackPanel Spacing="10">
                            <TextBlock Text="OpenAI" FontWeight="Bold" FontSize="14"/>
                            
                            <Grid ColumnDefinitions="Auto,*,Auto" IsVisible="{Binding HasOpenaiKey}">
                                <TextBlock Grid.Column="0" Text="Current Key:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="{Binding OpenaiKeyDisplay}" 
                                          VerticalAlignment="Center"
                                          FontFamily="Consolas,Courier New,monospace"/>
                                <Button Grid.Column="2" 
                                       Content="Delete" 
                                       Click="DeleteOpenaiKey_Click"
                                       Margin="10,0,0,0"/>
                            </Grid>
                            
                            <StackPanel Spacing="10" IsVisible="{Binding !HasOpenaiKey}">
                                <TextBox Text="{Binding OpenaiKeyInput}" 
                                        Watermark="sk-..."
                                        PasswordChar="•"/>
                                <Button Content="Add" 
                                       Click="AddOpenaiKey_Click"
                                       HorizontalAlignment="Right"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- DeepSeek -->
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                        <StackPanel Spacing="10">
                            <TextBlock Text="DeepSeek" FontWeight="Bold" FontSize="14"/>
                            
                            <Grid ColumnDefinitions="Auto,*,Auto" IsVisible="{Binding HasDeepseekKey}">
                                <TextBlock Grid.Column="0" Text="Current Key:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="{Binding DeepseekKeyDisplay}" 
                                          VerticalAlignment="Center"
                                          FontFamily="Consolas,Courier New,monospace"/>
                                <Button Grid.Column="2" 
                                       Content="Delete" 
                                       Click="DeleteDeepseekKey_Click"
                                       Margin="10,0,0,0"/>
                            </Grid>
                            
                            <StackPanel Spacing="10" IsVisible="{Binding !HasDeepseekKey}">
                                <TextBox Text="{Binding DeepseekKeyInput}" 
                                        Watermark="sk-..."
                                        PasswordChar="•"/>
                                <Button Content="Add" 
                                       Click="AddDeepseekKey_Click"
                                       HorizontalAlignment="Right"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Anlatan -->
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                        <StackPanel Spacing="10">
                            <TextBlock Text="Anlatan" FontWeight="Bold" FontSize="14"/>
                            
                            <Grid ColumnDefinitions="Auto,*,Auto" IsVisible="{Binding HasAnlatanKey}">
                                <TextBlock Grid.Column="0" Text="Current Key:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="{Binding AnlatanKeyDisplay}" 
                                          VerticalAlignment="Center"
                                          FontFamily="Consolas,Courier New,monospace"/>
                                <Button Grid.Column="2" 
                                       Content="Delete" 
                                       Click="DeleteAnlatanKey_Click"
                                       Margin="10,0,0,0"/>
                            </Grid>
                            
                            <StackPanel Spacing="10" IsVisible="{Binding !HasAnlatanKey}">
                                <TextBox Text="{Binding AnlatanKeyInput}" 
                                        Watermark="Enter API key..."
                                        PasswordChar="•"/>
                                <Button Content="Add" 
                                       Click="AddAnlatanKey_Click"
                                       HorizontalAlignment="Right"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Divider -->
                    <Separator Margin="0,10"/>

                    <!-- Vector databases section -->
                    <TextBlock Text="Vector databases" 
                               FontWeight="Bold" 
                               FontSize="16"
                               Margin="0,10,0,10"/>

                    <!-- Storage Provider Selector -->
                    <StackPanel Spacing="10">
                        <TextBlock Text="Storage Provider:" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <RadioButton GroupName="VectorStorage"
                                        Content="Supabase"
                                        IsChecked="{Binding IsSupabaseSelected}"
                                        Checked="SelectSupabase_Click"
                                        MinWidth="120"/>
                            <RadioButton GroupName="VectorStorage"
                                        Content="Qdrant"
                                        IsChecked="{Binding IsQdrantSelected}"
                                        Checked="SelectQdrant_Click"
                                        MinWidth="120"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Supabase -->
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                        <StackPanel Spacing="10">
                            <TextBlock Text="Supabase" FontWeight="Bold" FontSize="14"/>
                            
                            <Grid ColumnDefinitions="Auto,*,Auto" IsVisible="{Binding HasSupabaseKey}">
                                <TextBlock Grid.Column="0" Text="Current Key:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="{Binding SupabaseKeyDisplay}" 
                                          VerticalAlignment="Center"
                                          FontFamily="Consolas,Courier New,monospace"/>
                                <Button Grid.Column="2" 
                                       Content="Delete" 
                                       Click="DeleteSupabaseKey_Click"
                                       Margin="10,0,0,0"/>
                            </Grid>
                            
                            <StackPanel Spacing="10" IsVisible="{Binding !HasSupabaseKey}">
                                <TextBox Text="{Binding SupabaseKeyInput}" 
                                        Watermark="Enter API key..."
                                        PasswordChar="•"/>
                                <Button Content="Add" 
                                       Click="AddSupabaseKey_Click"
                                       HorizontalAlignment="Right"/>
                            </StackPanel>

                            <!-- URL field (always visible) -->
                            <StackPanel Spacing="5">
                                <TextBlock Text="Project URL:" FontWeight="SemiBold"/>
                                <TextBox Text="{Binding SupabaseUrlInput}" 
                                        Watermark="https://xxxxx.supabase.co"/>
                                <Button Content="Save URL" 
                                       Click="SaveSupabaseUrl_Click"
                                       HorizontalAlignment="Right"
                                       Margin="0,5,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Qdrant -->
                    <Border BorderBrush="Gray" BorderThickness="1" Padding="15" CornerRadius="5">
                        <StackPanel Spacing="10">
                            <TextBlock Text="Qdrant" FontWeight="Bold" FontSize="14"/>
                            
                            <Grid ColumnDefinitions="Auto,*,Auto" IsVisible="{Binding HasQdrantKey}">
                                <TextBlock Grid.Column="0" Text="Current Key:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <TextBlock Grid.Column="1" 
                                          Text="{Binding QdrantKeyDisplay}" 
                                          VerticalAlignment="Center"
                                          FontFamily="Consolas,Courier New,monospace"/>
                                <Button Grid.Column="2" 
                                       Content="Delete" 
                                       Click="DeleteQdrantKey_Click"
                                       Margin="10,0,0,0"/>
                            </Grid>
                            
                            <StackPanel Spacing="10" IsVisible="{Binding !HasQdrantKey}">
                                <TextBox Text="{Binding QdrantKeyInput}" 
                                        Watermark="Enter API key..."
                                        PasswordChar="•"/>
                                <Button Content="Add" 
                                       Click="AddQdrantKey_Click"
                                       HorizontalAlignment="Right"/>
                            </StackPanel>

                            <!-- URL field (always visible) -->
                            <StackPanel Spacing="5">
                                <TextBlock Text="Cluster URL:" FontWeight="SemiBold"/>
                                <TextBox Text="{Binding QdrantUrlInput}" 
                                        Watermark="https://xxxxx.qdrant.io"/>
                                <Button Content="Save URL" 
                                       Click="SaveQdrantUrl_Click"
                                       HorizontalAlignment="Right"
                                       Margin="0,5,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </TabItem>
    </TabControl>
</Window>
